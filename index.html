<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WILL - 早稲田大学ITサークル | トップページ</title>
    <meta name="description" content="WILLは早稲田大学のプログラミング・ITサークルです。完全無料でプログラミングが学べ、イベントや企業案件による成長も遊びもあるサークルです。" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Anton&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Jomolhari&family=Noto+Sans+JP:wght@400;700&family=Tinos:ital,wght@0,400;0,700;1,400;1,700&family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./assets/css/common.css" />
    <link rel="stylesheet" href="./assets/css/components.css" />
    <link rel="stylesheet" href="./assets/css/pages/index.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="./assets/js/main.js"></script>
    <script src="./assets/js/activity-photo.js"></script>
  </head>
  <body>
    <!-- ヘッダー部分（共通化） -->
    <div id="header-container"></div>
    <section class="head-image-container">
      <img src="./assets/images/top-page-image.webp" alt="Top" />
      <div class="head-letter">Top</div>
    </section>
    <section class="about-will-section">
      <div class="section-inner">
        <div class="will-title-cover">
          <h2 class="section-title">WILLについて</h2>
        </div>
        <div class="about-will-cover">
          <div class="about-will-description description">
            WILLは、2020年8月に設立された早稲田大学ITサークル<br>
            （WASEDA IT Leader Lab）です。<br>
            オンラインIT学習コミュニティのPlayGroundと協力して、<br>
            プログラミングやデザイン、データサイエンスを学んでいます。<br>
            私たちは、3つのビジョンと目標を掲げて活動しています。
          </div>
        </div>
      </div>
    </section>
    <section class="latest-information-section">
      <div class="section-inner">
        <h2 class="section-title">活動の様子</h2>
        <div class="carousel-container">
          <div class="carousel-track">
            <div class="carousel-inner">
              <!-- アイテムはJavaScriptで動的に追加されます -->
            </div>
          </div>
          <div class="move-buttons">
            <img class="left" src="./assets/images/pages/index/arrow_left.svg" alt="前へ" />
            <img class="right" src="./assets/images/pages/index/arrow_right.svg" alt="次へ" />
          </div>
        </div>
        <a class="activity-button" href="./pages/activities/">
          <div class="button-frame button-white">
            <h4 class="button-text button-white">活動紹介はこちら</h4>
          </div>
        </a>
      </div>
    </section>
    <section class="about-seminar-section">
      <div class="section-inner align-right">
        <div class="about-seminar-content">
          <h2 class="section-title">学習について</h2>
          <div class="description-frame">
            <div class="about-seminar-description description">
              WILLではPlayGroundのゼミクラスタ制に参加し、興味のある分野を選択して学んでいきます。<br>
              入会したら、ゼミ一覧から興味のあるゼミを選択して参加しましょう！<br>
              各ゼミは基本的にDiscordを使用してオンラインで活動しています。
            </div>
          </div>
        </div>
        <a class="seminar-detail-button" href="./pages/seminars/">
          <div class="button-frame button-gray">
            <h4 class="button-text button-gray">ゼミの詳細はこちら</h4>
          </div>
        </a>
      </div>
    </section>
    <section class="join-flow-and-condition-section">
      <div class="section-inner">
        <h2 class="section-title">入会フロー</h2>
        <div class="join-flow-and-condition-content">
          <div class="join-flow-details">
            <div class="join-flow-block">
              <div class="join-flow-title">
                <div class="step">
                  <div class="step-number">01</div>
                </div>
                <div class="step-content">
                  <div class="step-title">オンライン説明会</div>
                  <div class="step-text">15-30 mins</div>
                </div>
              </div>
              <p class="step-explanation">
                ZOOMにて活動内容、入会方法についての説明会を行っています。<br>
                参加方法は下のボタン「詳しい入会フローはこちら」からご確認ください！
              </p>
            </div>
            <div class="join-flow-block">
              <div class="join-flow-title">
                <div class="step">
                  <div class="step-number">02</div>
                </div>
                <div class="step-content">
                  <div class="step-title">セットアップ</div>
                  <div class="step-text">30 mins</div>
                </div>
              </div>
              <p class="step-explanation">
                説明会後、入会された方はWILLの活動で使用するツールのセットアップを行います。<br>
                初心者の方でも安心して活動を始められるよう、メンバーがサポートします。
              </p>
            </div>
          </div>
          <div class="join-conditions">
            <div class="join-condition-block">
              <div class="condition-title">入会条件</div>
              <div class="condition-detail">学部1年生～修士1年生の方</div>
              <div class="detail-mini">(1年以上活動に参加できる方)</div>
            </div>
            <div class="join-condition-block">
              <div class="condition-title">入会時期</div>
              <div class="condition-detail">年間を通していつでも入会可能！</div>
            </div>
          </div>
        </div>
        <a class="seminar-detail-button" href="./pages/join/">
          <div class="button-frame button-gray">
            <h4 class="button-text button-gray">詳しい入会フローはこちら</h4>
          </div>
        </a>
      </div>
    </section>
    <!-- フッター部分（共通化） -->
    <div id="footer-container"></div>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const track = document.querySelector(".carousel-inner");
        const leftBtn = document.querySelector(".left");
        const rightBtn = document.querySelector(".right");
        const carouselTrack = document.querySelector(".carousel-track");

        const cardGap = 48;
        const cardWidth = 331;
        let visibleCount;
        let cloneCount;
        let itemWidth = cardWidth + cardGap;
        let currentIndex;
        let totalItems;
        let autoScrollInterval;
        let isAnimating = false; // アニメーション中フラグ

        // Save original sources for hover effects
        const leftSrc = "./assets/images/pages/index/arrow_left.svg";
        const leftHoverSrc = "./assets/images/pages/index/arrow-left-hover.svg";
        const rightSrc = "./assets/images/pages/index/arrow_right.svg";
        const rightHoverSrc = "./assets/images/pages/index/arrow-right-hover.svg";

        // タッチデバイスかどうかを判定
        let isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
        let touchTimeout = null;

        // マウスイベント（タッチデバイス以外）
        if (!isTouchDevice) {
          leftBtn.addEventListener(
            "mouseover",
            () => (leftBtn.src = leftHoverSrc)
          );
          leftBtn.addEventListener("mouseout", () => (leftBtn.src = leftSrc));
          rightBtn.addEventListener(
            "mouseover",
            () => (rightBtn.src = rightHoverSrc)
          );
          rightBtn.addEventListener("mouseout", () => (rightBtn.src = rightSrc));
        }

        // タッチデバイス用：タッチ開始時にホバー画像に変更
        if (isTouchDevice) {
          leftBtn.addEventListener("touchstart", () => {
            leftBtn.src = leftHoverSrc;
            // 既存のタイマーをクリア
            if (touchTimeout) clearTimeout(touchTimeout);
          });
          
          rightBtn.addEventListener("touchstart", () => {
            rightBtn.src = rightHoverSrc;
            // 既存のタイマーをクリア
            if (touchTimeout) clearTimeout(touchTimeout);
          });
        }

        // Calculate visible count based on screen width
        function calculateVisibleCount() {
          const containerWidth = carouselTrack.offsetWidth;
          // Calculate how many cards can fit (including gaps)
          const calculatedCount = Math.floor((containerWidth + cardGap) / (cardWidth + cardGap));
          // Minimum 1, maximum based on available space
          return Math.max(1, calculatedCount);
        }

        // Reset auto-scroll timer
        function resetAutoScroll() {
          clearInterval(autoScrollInterval);
          autoScrollInterval = setInterval(moveNext, 5000);
        }

        // Calculate center offset to position current item at center
        function getCenterOffset() {
          const containerWidth = carouselTrack.offsetWidth;
          return (containerWidth - cardWidth) / 2;
        }

        function initializeCarousel() {
          // Remove all items and rebuild
          const originalItems = [...track.querySelectorAll(".item")].filter(
            (item) => !item.classList.contains("cloned")
          );
          track.innerHTML = "";
          originalItems.forEach((item) => track.appendChild(item));
          totalItems = originalItems.length;

          if (totalItems === 0) return;

          // Calculate visible count based on current screen width
          visibleCount = calculateVisibleCount();
          
          // Clone for infinite scroll (need extra clones for center alignment)
          cloneCount = Math.max(visibleCount, 3);
          for (let i = 0; i < cloneCount; i++) {
            const cloneFirst = originalItems[i % totalItems].cloneNode(true);
            const cloneLast = originalItems[(totalItems - 1 - (i % totalItems)) % totalItems].cloneNode(true);
            cloneFirst.classList.add("cloned");
            cloneLast.classList.add("cloned");
            track.appendChild(cloneFirst);
            track.insertBefore(cloneLast, track.firstChild);
          }

          currentIndex = cloneCount;
          itemWidth = cardWidth + cardGap;
          track.style.transition = "none";
          
          // Center the current item
          const centerOffset = getCenterOffset();
          const offset = currentIndex * itemWidth - centerOffset;
          track.style.transform = `translateX(-${offset}px)`;

          // Restart auto-scroll
          resetAutoScroll();
        }

        function updateCarousel(smooth = true) {
          if (!smooth) {
            track.style.transition = "none";
          } else {
            track.style.transition = "transform 0.5s ease-in-out";
          }
          // Center the current item
          const centerOffset = getCenterOffset();
          const offset = currentIndex * itemWidth - centerOffset;
          track.style.transform = `translateX(-${offset}px)`;
        }

        // ボタンの無効化/有効化
        function setButtonsDisabled(disabled) {
          isAnimating = disabled;
          leftBtn.style.opacity = disabled ? "0.5" : "1";
          rightBtn.style.opacity = disabled ? "0.5" : "1";
          leftBtn.style.pointerEvents = disabled ? "none" : "auto";
          rightBtn.style.pointerEvents = disabled ? "none" : "auto";
          
          // 有効化時は画像を元に戻す（タッチデバイス対応）
          if (!disabled) {
            leftBtn.src = leftSrc;
            rightBtn.src = rightSrc;
          }
        }

        function moveNext() {
          if (isAnimating) return;
          
          setButtonsDisabled(true);
          currentIndex++;
          updateCarousel(true);

          if (currentIndex >= totalItems + cloneCount) {
            setTimeout(() => {
              currentIndex = cloneCount;
              updateCarousel(false);
              setButtonsDisabled(false);
            }, 500);
          } else {
            setTimeout(() => setButtonsDisabled(false), 500);
          }
          
          // Reset auto-scroll timer when manually moved
          resetAutoScroll();
        }

        function movePrev() {
          if (isAnimating) return;
          
          setButtonsDisabled(true);
          currentIndex--;
          updateCarousel(true);

          if (currentIndex < cloneCount) {
            setTimeout(() => {
              currentIndex = totalItems + cloneCount - 1;
              updateCarousel(false);
              setButtonsDisabled(false);
            }, 500);
          } else {
            setTimeout(() => setButtonsDisabled(false), 500);
          }
          
          // Reset auto-scroll timer when manually moved
          resetAutoScroll();
        }

        rightBtn.addEventListener("click", moveNext);
        leftBtn.addEventListener("click", movePrev);

        // Responsive handling
        window.addEventListener("resize", () => {
          const newCount = calculateVisibleCount();
          if (newCount !== visibleCount) {
            visibleCount = newCount;
            initializeCarousel();
          }
        });

        // Initial setup
        initializeCarousel();
      });
    </script>
  </body>
</html>
